<p class="gaTitle">助学金配置 <span class="gatip2">（学校总人数：{{vm.studentNum.totalNum?vm.studentNum.totalNum:'0'}}人， 已认定的经济困难人数：{{vm.studentNum.povertyNum?vm.studentNum.povertyNum:'0'}}人）</span></p><div class="gaBody"><div class="gaTop"><p class="gaFillLeft">配置助学金类型</p><div class="gaFillRight"><a href="javaScript:" class="gaSearch" ng-click="vm.grantsModalShow()">添加</a></div></div><div class="gaMain"><table ng-table="vm.tableParams" class="table" show-filter="false"><tr ng-repeat="des in $data"><td title="'序号'">{{des.index}}</td><td title="'助学金名称'">{{des.name}}</td><td title="'助学金等级'">{{des.levelName}}</td><td title="'助学金设立机构'">{{des.organization}}</td><td title="'学年'">{{des.schoolYear}}</td><td title="'资助金额'">{{des.subsidizeMoney}}</td><td title="'全部名额'">{{des.subsidizeNum}}</td><td title="'预留名额'">{{des.reserveNum}}</td><td title="'可配置名额'">{{des.allot}}</td><td title="'配置学院名额'"><a href="javaScript:;" ng-click="vm.mannerSchoolMount(des)">{{des.isDistribute? "编辑": "开始配置"}}</a></td><td title="'名额申请'"><a href="javaScript:;" ng-click="vm.newApplys(des)">{{des.newApplys.length!==0? "有新申请": "无"}}</a></td><td title="'操作'"><a href="javaScript:;" ng-click="vm.grantsModalShow(des)">修改</a> <a href="javaScript:;" ng-click="vm.delete(des)">删除</a></td></tr></table></div></div><div class="modal fade add-grants-modal" id="addGrants" tabindex="-1" role="dialog" aria-labelledby="addGrantsModal"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="addGrantsModal">{{vm.currentGrants.title}}</h4></div><div class="modal-body"><form class="form-horizontal" role="form" name="vm.grantsForm" novalidate ng-if="!vm.s"><div class="form-group"><label class="col-sm-2 control-label">是否分等级</label><div class="col-sm-10"><div class="radio"><label><input type="radio" name="type" value="1" ng-model="vm.currentGrants.type" ng-checked="vm.currentGrants.type === 1" ng-change="typeChange()"> 是</label><label><input type="radio" name="type" value="0" ng-model="vm.currentGrants.type" ng-checked="vm.currentGrants.type === 0" ng-change="typeChange()"> 否</label></div></div></div><div class="form-group"><label for="grantsName" class="col-sm-2 control-label">助学金名称：</label><div class="col-sm-10"><input type="text" class="form-control" id="grantsName" placeholder="助学金名称" required ng-model="vm.currentGrants.name" name="grantsName" ng-class="{'border-error':vm.grantsForm.grantsName.$invalid&&vm.grantsSubmit}"></div></div><div class="form-group"><label for="organization" class="col-sm-2 control-label">设立机构：</label><div class="col-sm-10"><input type="text" class="form-control" id="organization" placeholder="设立机构" required ng-model="vm.currentGrants.organization" name="organization" ng-class="{'border-error':vm.grantsForm.organization.$invalid&&vm.grantsSubmit}"></div></div><div class="form-group"><label class="col-sm-2 control-label">发放时间：</label><div class="col-sm-10"><p class="input-group inline-block vertical-middle"><input type="text" class="form-control" uib-datepicker-popup placeholder="请选择时间" datepicker-options="vm.startTimeOptions" ng-model="vm.currentGrants.startTime" is-open="startTime" readonly="readonly" ng-click="startTime = true" required show-button-bar="false" name="startTime" ng-class="{'border-error':vm.grantsForm.startTime.$invalid&&vm.grantsSubmit}"> <span class="input-group-btn"><button type="button" class="btn btn-default btn-icon" ng-click="startTime = true"><i class="glyphicon glyphicon-calendar"></i></button></span></p>&nbsp;&nbsp;~&nbsp;&nbsp;<p class="input-group inline-block vertical-middle"><input type="text" class="form-control" uib-datepicker-popup placeholder="请选择时间" ng-model="vm.currentGrants.endTime" is-open="endTime" datepicker-options="vm.endTimeOptions" readonly="readonly" ng-click="endTime = true" required show-button-bar="false" name="endTime" ng-class="{'border-error':vm.grantsForm.endTime.$invalid&&vm.grantsSubmit}"> <span class="input-group-btn"><button type="button" class="btn btn-default btn-icon" ng-click="endTime = true"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div></div><div class="form-group"><label class="col-sm-2 control-label">学年：</label><div class="col-sm-10"><select class="form-control w140s" ng-model="vm.schoolYear" ng-options="year.name as year.name for year in vm.schoolYearList"></select></div></div><div ng-if="vm.currentGrants.type==1" class="slide-top"><div ng-repeat="item in vm.currentGrants.level track by $index" class="slide-top"><div class="clearfix mt20"><span class="fs16">等级{{$index+1}}</span> <a class="pull-right" href="javascript:;" ng-click="removeLevel($index)">删除</a></div><div class="form-group form-group-sp"><label class="col-sm-2 control-label">助学金等级：</label><div class="col-sm-1"><input type="text" class="form-control w100s" id="grantsAmount{{$index}}" ng-model="item.levelName" required placeholder="助学金等级" name="amout{{$index}}" ng-class="{'border-error':vm.grantsForm['amount' + $index].$invalid&&vm.grantsSubmit}"></div><label for="grantsMoney{{$index}}" class="col-sm-2 control-label tr">资助金额：</label><div class="col-sm-1"><input type="text" class="form-control w90s" id="grantsMoney{{$index}}" ng-model="item.subsidizeMoney" ng-pattern="/^[0-9]+$/" maxlength="10" required placeholder="助学金金额" name="money{{$index}}" ng-class="{'border-error':vm.grantsForm['money' + $index].$invalid&&vm.grantsSubmit}"></div><label for="grantsAmount{{$index}}" class="col-sm-2 control-label tr">资助名额：</label><div class="col-sm-1"><input type="text" class="form-control w100s" id="grantsAmount{{$index}}" ng-model="item.subsidizeNum" ng-pattern="/^[0-9]+$/" maxlength="10" required placeholder="助学金名额" name="amount{{$index}}" ng-class="{'border-error':vm.grantsForm['amount' + $index].$invalid&&vm.grantsSubmit}"></div><label for="grantsAmount{{$index}}" class="col-sm-2 control-label tr">预留名额：</label><div class="col-sm-1"><input type="text" class="form-control w100s" id="grantsok{{$index}}" ng-model="item.reserveNum" ng-pattern="/^[0-9]+$/" maxlength="10" required placeholder="预留名额" name="amount{{$index}}" ng-class="{'border-error':vm.grantsForm['amount' + $index].$invalid&&vm.grantsSubmit}"></div></div><div class="form-group"><label for="evaluateCondition{{$index}}" class="col-sm-2 control-label">评定条件：</label><div class="col-sm-10"><textarea class="form-control" id="evaluateCondition{{$index}}" ng-model="item.evaluateCondition" required placeholder="评定条件" cols="30" rows="5" name="evaluateCondition{{$index}}" ng-class="{'border-error':vm.grantsForm['evaluateCondition'+$index].$invalid&&vm.grantsSubmit}"></textarea></div></div><div class="form-group"><label class="col-sm-2 control-label">申请表格</label><div class="col-sm-10"><upload url="item.url" http="/grantsCommon/uploadFile"></upload></div></div></div><a href="javascript:;" class="fs16" ng-click="vm.addLevel()">+添加等级</a></div><div ng-if="vm.currentGrants.type==0" class="slide-top"><div class="form-group form-group-sp"><label for="grantsMoney" class="col-sm-2 control-label">资助金额：</label><div class="col-sm-2"><input type="text" class="form-control w140s" id="grantsMoney" placeholder="助学金金额（元）" ng-model="vm.currentGrants.level[0].subsidizeMoney" ng-pattern="/^[0-9]+$/" maxlength="10" required name="money" ng-class="{'border-error':vm.grantsForm.money.$invalid&&vm.grantsSubmit}"></div><label for="totalMember" class="col-sm-2 control-label tr">资助名额：</label><div class="col-sm-2"><input type="text" class="form-control w140s" id="totalMember" placeholder="助学金名额" ng-model="vm.currentGrants.level[0].subsidizeNum" ng-pattern="/^[0-9]+$/" maxlength="10" required name="amount" ng-class="{'border-error':vm.grantsForm.amount.$invalid&&vm.grantsSubmit}"></div><label class="col-sm-2 control-label tr">预留名额：</label><div class="col-sm-2"><input type="text" class="form-control w140s" id="totalMmber" placeholder="预留名额" ng-model="vm.currentGrants.level[0].reserveNum" ng-pattern="/^[0-9]+$/" maxlength="10" required name="amount" ng-class="{'border-error':vm.grantsForm.amount.$invalid&&vm.grantsSubmit}"></div></div><div class="form-group"><label for="conditions" class="col-sm-2 control-label">评定条件：</label><div class="col-sm-10"><textarea class="form-control" id="conditions" placeholder="评定条件" cols="30" ng-model="vm.currentGrants.level[0].evaluateCondition" required rows="5" name="evaluateCondition" ng-class="{'border-error':vm.grantsForm.evaluateCondition.$invalid&&vm.grantsSubmit}"></textarea></div></div><div class="form-group"><label class="col-sm-2 control-label">申请表格</label><div class="col-sm-10"><upload url="vm.currentGrants.level[0].url" http="/grantsCommon/uploadTemplate"></upload></div></div></div></form></div><div class="modal-footer tc"><button type="button" data-dismiss="modal" aria-label="Close" class="btn btn-default">取消</button> <button type="button" ng-click="addGrants()" class="btn btn-primary">保存</button></div></div></div></div>